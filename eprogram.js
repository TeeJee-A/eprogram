let users = [
  {
    id: "123456789",
    createdDate: "2021-01-06T00:00:00.000Z",
    status: "En validation",
    firstName: "Mohamed",
    lastName: "Taha",
    userName: "mtaha",
    registrationNumber: "2584",
    action: "",
  },
  {
    id: "987654321",
    createdDate: "2021-07-25T00:00:00.000Z",
    status: "Validé",
    firstName: "Hamid",
    lastName: "Orrich",
    userName: "horrich",
    registrationNumber: "1594",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
  {
    id: "852963741",
    createdDate: "2021-09-15T00:00:00.000Z",
    status: "Rejeté",
    firstName: "Rachid",
    lastName: "Mahidi",
    userName: "rmahidi",
    registrationNumber: "3576",
    action: "",
  },
];

let modale = [
  {
    label: "Nom",
  },
  {
    label: "Nom d'utilisateur",
  },
  {
    label: "Matricule",
  },
  {
    label: "prenom",
  },
  {
    label: "Date de creation",
  },
  {
    label: "Etat",
  },
];

var modal = document.getElementById("myModal");
var close = document.getElementById("closemodal");
var btn = document.getElementById("myBtn");

close.onclick = function () {
modal.style.display = "none";
close.style.cursor = "pointer"
}

btn.onclick = function () {
  modal.style.display = "block";
};

window.onclick = function (event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
};

var enrbtn = document.getElementById("enregistrer");

enrbtn.onclick = function () {
  var lastName = document.getElementById("lastName").value;
  var firstName = document.getElementById("firstName").value;
  var userName = document.getElementById("userName").value;
  var createdDate = document.getElementById("createdDate").value;
  var registrationNumber = document.getElementById("registrationNumber").value;
  var status = document.getElementById("status").value;

  if (
    !userName.match(/^[a-zA-Z0-9](?:[a-zA-Z0-9_-]{1,14}[a-zA-Z0-9])?$/) ||
    !registrationNumber.match(/^\d+$/) ||
    !firstName.match(/^[a-zA-Z]+$/) ||
    !lastName.match(/^[a-zA-Z]+$/)
  ) {
    let div = document.getElementById("error");
    let span = document.createElement("span");
    span.innerText = "invalid input";
    div.appendChild(span);
    span.classList.add("parsing");
    return;
  }
  document.getElementById("lastName").value = "";
  document.getElementById("firstName").value = "";
  document.getElementById("userName").value = "";
  document.getElementById("createdDate").value = "";
  document.getElementById("registrationNumber").value = "";
  document.getElementById("status").value = "";

  users.push({
    id: generateUUID(),
    createdDate,
    status,
    firstName,
    lastName,
    userName,
    registrationNumber,
    action: "",
  });
  renderList(users);
  modal.style.display = "none";
};

displayList(users);

function displayList(users) {
  let tbody = document.getElementById("tableBody");
  users.forEach((user, index) => {
    let tr = document.createElement("tr");
    tr.style.borderTop = "1px solid gray";
    Object.entries(user).forEach((value) => {
      if (value[0] === "createdDate") {
        value[1] ? (value[1] = new Date(value[1])) : (value[1] = new Date());
        value[1].toString();
        value[1] =
          value[1].getDate() +
          "/" +
          (value[1].getMonth() + 1) +
          "/" +
          value[1].getFullYear();
      }
      let td = document.createElement("td");
      let div = document.createElement("div");
      td.classList.add("bordered-row");
      if (value[1] === "En validation") {
        div.classList.add("status");
        div.style.backgroundColor = "#fdb64d"
      } else if (value[1] === "Validé") {
        div.classList.add("status");
        div.style.backgroundColor = "#5be881"
      } else if (value[1] === "Rejeté") {
        div.classList.add("status");
        div.style.backgroundColor = "#ff0000"
      }
      if (value[0] === "action") {
        let icon = document.createElement("img");
        let button = document.createElement("button");
        button.classList.add("buttonTrash");
        div.classList.add("actionDiv");
        icon.classList.add('trash')
        icon.src = "trash.svg";
        button.addEventListener("click", () => {
          users.splice(index, 1);
          renderList(users);
        });
        div.appendChild(button);
        button.appendChild(icon);
      } else {
        div.innerText = value[1];
      }
      td.appendChild(div);
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });
}

function renderList(users) {
  let tbody = document.getElementById("tableBody");
  tbody.innerHTML = "";
  displayList(users);
}

function generateUUID() {
  var uuid = "";
  for (var i = 0; i < 8; i++) {
    uuid += Math.floor(Math.random() * 10);
  }
  return uuid;
}
